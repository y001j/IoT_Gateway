# GPS地理信息编辑器使用指南

## 概述

GPS地理信息编辑器是IoT Gateway复合数据规则编辑系统的专用组件，提供了简洁实用的GPS坐标编辑和地理操作配置功能。

## 主要特性

### 1. 坐标编辑 (GpsFieldEditor)
- **精度支持**: 6位小数精度 (±0.000001度 ≈ 0.1米)
- **实时验证**: 纬度(-90°到90°)和经度(-180°到180°)范围检查
- **坐标系支持**: WGS84 (GPS标准)、GCJ02 (国内常用)、BD09 (百度坐标)
- **常用示例**: 内置北京、上海、深圳等城市坐标示例
- **可选海拔**: 支持海拔高度输入(米)

### 2. GPS操作配置 (GpsActionEditor)
支持4种核心GPS操作类型：

#### 距离计算 (Distance)
- 计算GPS设备到参考点的距离
- 支持单位：米(m)、千米(km)、英里(mile)
- 输出：数值型距离结果

#### 方位角计算 (Bearing)
- 计算相对于参考点的方位角
- 输出：0°-360°角度值 (0°为正北方向，顺时针)
- 用途：设备朝向分析、轨迹跟踪

#### 坐标系转换 (Coordinate Convert)
- 支持WGS84、GCJ02、BD09之间的转换
- 解决国内GPS偏移问题
- 适用于多地图服务集成

#### 地理围栏检查 (Geofence)
- 圆形围栏检查
- 可配置围栏中心点和半径
- 输出：布尔值 (true=在围栏内, false=在围栏外)

## 使用示例

### 1. 创建距离监控规则

**场景**: 监控设备是否偏离中心点100米范围

**GPS条件配置**:
```
数据类型: GPS/地理位置
字段选择: distance_to_center > 100
```

**GPS动作配置**:
- 操作类型: 距离计算
- 参考点: 39.9042, 116.4074 (天安门)
- 单位: 米
- 输出字段: distance_to_center

### 2. 创建地理围栏报警

**场景**: 车辆离开指定区域时触发报警

**GPS条件配置**:
```
数据类型: GPS/地理位置  
字段选择: in_safe_zone == false
```

**GPS动作配置**:
- 操作类型: 地理围栏检查
- 围栏中心: 31.2304, 121.4737 (上海外滩)
- 半径: 1000米
- 输出字段: in_safe_zone

### 3. 坐标系转换

**场景**: 将GPS原始坐标转换为国内地图坐标

**GPS动作配置**:
- 操作类型: 坐标系转换
- 源坐标系: WGS84 (GPS原始)
- 目标坐标系: GCJ02 (高德/腾讯地图)
- 输出字段: converted_coords

## 技术特点

### 简洁设计原则
- **无地图依赖**: 不引入复杂的地图API和组件
- **IoT专注**: 面向设备数据处理，不是地图应用
- **实用功能**: 只包含IoT场景需要的核心GPS操作
- **高性能**: 轻量化组件，快速渲染

### 用户体验优化
- **可视化状态**: 实时显示坐标有效性
- **智能提示**: 内置常用城市坐标示例
- **错误预防**: 输入范围限制和格式验证
- **配置集成**: 与复合数据规则编辑器无缝集成

### 数据兼容性
- **多坐标系**: 支持国内外主流坐标系
- **精度保证**: 6位小数满足大部分IoT应用精度需求
- **单位灵活**: 支持公制和英制单位
- **格式统一**: 与后端GPS处理模块数据格式匹配

## 最佳实践

1. **距离监控**: 用于设备位置偏移检测、围栏报警
2. **轨迹分析**: 结合方位角计算分析设备移动轨迹
3. **多地图兼容**: 使用坐标转换适配不同地图服务
4. **精度选择**: 根据实际应用精度需求选择合适的小数位数

## 注意事项

- GPS坐标精度：6位小数约等于0.1米精度，满足大部分IoT应用
- 坐标系选择：国内应用建议使用GCJ02，避免偏移问题
- 围栏大小：围栏半径建议不小于设备GPS精度的3倍
- 性能考虑：频繁的距离计算可能影响性能，建议适当限制更新频率