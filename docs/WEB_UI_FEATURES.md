# IoT Gateway Web UI 功能详解

## 功能概述

IoT Gateway Web UI 提供了完整的 IoT 系统管理功能，包括实时监控、设备管理、规则配置、告警处理等核心功能。界面设计简洁直观，支持响应式布局，适配各种设备屏幕。

## 1. 用户认证与权限管理

### 1.1 登录认证
**功能描述**: 安全的用户登录系统，支持JWT双Token认证机制。

**主要特性**:
- 用户名/密码登录
- 记住登录状态
- 自动Token刷新
- 登录失败锁定保护
- 安全的登出机制

**技术实现**:
```typescript
// 登录接口
interface LoginRequest {
  username: string;
  password: string;
  rememberMe?: boolean;
}

interface LoginResponse {
  accessToken: string;
  refreshToken: string;
  user: UserInfo;
  expiresIn: number;
}
```

**安全特性**:
- JWT Token 自动刷新
- Token 存储在内存中防止XSS
- 自动登出过期会话
- 密码强度验证

### 1.2 权限控制
**功能描述**: 基于角色的访问控制(RBAC)，确保用户只能访问授权的功能。

**权限角色**:
- **Admin (管理员)**: 完全访问权限
- **Operator (操作员)**: 基本操作权限
- **Viewer (查看者)**: 只读权限

**权限控制点**:
- 页面路由访问控制
- API接口权限验证
- 功能按钮显示控制
- 数据字段访问权限

## 2. 实时仪表板

### 2.1 系统概览
**功能描述**: 展示系统整体运行状态和关键指标的实时仪表板。

**核心指标**:
- **系统运行时间**: 显示系统持续运行的时间
- **活跃插件数量**: 当前正在运行的插件数目
- **实时数据点数**: 正在处理的数据点数量
- **连接状态**: WebSocket连接状态显示

**可视化组件**:
```typescript
// 统计卡片组件
<Statistic
  title="系统运行时间"
  value={uptime}
  prefix={<ThunderboltOutlined />}
  valueStyle={{ color: '#52c41a' }}
/>
```

### 2.2 系统资源监控
**功能描述**: 实时监控系统资源使用情况，包括CPU、内存、网络等。

**监控指标**:
- **CPU 使用率**: 实时CPU使用百分比
- **内存使用率**: 系统内存占用情况
- **网络流量**: 入站和出站网络流量
- **磁盘使用**: 存储空间使用情况

**可视化方式**:
- 进度条显示使用率
- 颜色编码(绿色正常，黄色警告，红色危险)
- 实时数据更新
- 历史趋势图表

### 2.3 实时数据流监控
**功能描述**: 展示IoT设备数据的实时流向和处理情况。

**数据可视化**:
- **实时折线图**: 显示数据变化趋势
- **数据表格**: 展示最新数据点详情
- **流量统计**: 数据吞吐量统计
- **设备状态**: 各设备连接状态

**图表特性**:
```typescript
// ECharts 配置
const chartOption = {
  title: { text: 'IoT数据实时监控' },
  xAxis: { type: 'time' },
  yAxis: { type: 'value' },
  series: [{
    type: 'line',
    smooth: true,
    animation: false,
    data: dataPoints
  }]
};
```

### 2.4 告警概览
**功能描述**: 显示最新的系统告警信息和告警统计。

**告警信息**:
- **告警级别**: Critical, Error, Warning, Info
- **告警来源**: 标识告警产生的组件或设备
- **告警时间**: 精确的时间戳
- **告警描述**: 详细的告警说明

**告警统计**:
- 按级别统计告警数量
- 按时间段统计告警趋势
- 未处理告警提醒
- 告警确认和处理状态

## 3. 插件管理

### 3.1 插件列表管理
**功能描述**: 展示和管理系统中所有的插件，包括南向适配器和北向连接器。

**插件信息展示**:
- **基本信息**: 名称、版本、类型、描述
- **运行状态**: Running, Stopped, Error, Starting
- **配置信息**: 插件配置参数
- **性能指标**: CPU、内存使用，数据处理量

**列表功能**:
- 搜索和过滤插件
- 按状态、类型分组显示
- 批量操作支持
- 分页浏览

### 3.2 插件控制操作
**功能描述**: 对插件进行启动、停止、重启等生命周期管理。

**控制操作**:
```typescript
// 插件控制接口
interface PluginControl {
  start(pluginId: string): Promise<void>;
  stop(pluginId: string): Promise<void>;
  restart(pluginId: string): Promise<void>;
  getStatus(pluginId: string): Promise<PluginStatus>;
}
```

**操作确认**:
- 重要操作需要二次确认
- 显示操作结果反馈
- 失败时显示详细错误信息
- 支持批量操作

### 3.3 插件配置管理
**功能描述**: 查看和编辑插件的配置参数。

**配置编辑器**:
- **JSON配置编辑**: 使用Monaco Editor
- **配置验证**: 实时语法和逻辑验证
- **配置模板**: 提供常用配置模板
- **配置备份**: 自动保存配置历史

**配置特性**:
- 语法高亮显示
- 自动补全功能
- 错误提示标记
- 实时预览效果

### 3.4 插件日志查看
**功能描述**: 查看插件运行日志，帮助调试和监控。

**日志功能**:
- **实时日志流**: 实时显示最新日志
- **日志级别过滤**: Debug, Info, Warn, Error
- **日志搜索**: 关键词搜索功能
- **日志下载**: 导出日志文件

**日志显示**:
```typescript
// 日志条目结构
interface LogEntry {
  timestamp: string;
  level: LogLevel;
  message: string;
  source: string;
  metadata?: Record<string, any>;
}
```

## 4. 规则引擎管理

### 4.1 规则列表与搜索
**功能描述**: 管理系统中的所有规则，支持创建、编辑、删除规则。

**规则信息**:
- **基本信息**: 规则名称、描述、创建时间
- **状态信息**: 启用/禁用状态、执行次数
- **条件信息**: 规则触发条件概要
- **动作信息**: 规则执行动作概要

**管理功能**:
- 规则快速搜索
- 按状态过滤规则
- 批量启用/禁用
- 规则复制和导入导出

### 4.2 规则创建与编辑
**功能描述**: 提供可视化的规则创建和编辑界面。

**规则组成**:
```typescript
// 规则结构
interface Rule {
  id: string;
  name: string;
  description: string;
  enabled: boolean;
  conditions: RuleCondition;
  actions: RuleAction[];
  priority: number;
}
```

**条件类型**:
- **简单条件**: 单一字段比较
- **复合条件**: AND/OR逻辑组合
- **表达式条件**: 自定义表达式
- **时间条件**: 基于时间的触发

**动作类型**:
- **告警动作**: 发送告警通知
- **转换动作**: 数据格式转换
- **过滤动作**: 数据过滤处理
- **转发动作**: 数据转发到其他系统

### 4.3 规则条件配置
**功能描述**: 配置规则的触发条件，支持多种条件类型和逻辑组合。

**条件配置器**:
- **字段选择器**: 选择数据字段
- **操作符选择**: 等于、大于、小于、包含等
- **值输入器**: 支持各种数据类型
- **逻辑组合器**: AND/OR条件组合

**高级条件**:
- 正则表达式匹配
- 数值范围判断
- 时间窗口条件
- 统计聚合条件

### 4.4 规则动作配置
**功能描述**: 配置规则触发后执行的动作。

**动作配置**:
- **告警配置**: 告警级别、通知渠道
- **数据转换**: 字段映射、格式转换
- **转发配置**: 目标地址、协议参数
- **脚本执行**: 自定义脚本动作

**动作编辑器**:
- 参数表单自动生成
- 配置预览和验证
- 测试功能支持
- 模板库支持

## 5. 告警管理

### 5.1 告警历史查看
**功能描述**: 查看系统产生的所有告警记录。

**告警信息**:
- **告警详情**: 标题、描述、级别、来源
- **时间信息**: 产生时间、确认时间、解决时间
- **状态信息**: 新建、已确认、已解决、已忽略
- **处理信息**: 处理人、处理备注

**查看功能**:
- 时间范围筛选
- 告警级别过滤
- 状态条件筛选
- 关键词搜索

### 5.2 告警处理操作
**功能描述**: 对告警进行确认、解决、忽略等处理操作。

**处理流程**:
1. **新建告警**: 系统自动创建
2. **告警确认**: 操作员确认告警
3. **问题处理**: 解决导致告警的问题
4. **告警解决**: 标记告警为已解决
5. **告警关闭**: 关闭已解决的告警

**批量操作**:
- 批量确认告警
- 批量解决告警
- 批量设置优先级
- 批量分配处理人

### 5.3 告警规则配置
**功能描述**: 配置告警的触发条件和处理规则。

**告警规则**:
```typescript
// 告警规则结构
interface AlertRule {
  id: string;
  name: string;
  condition: string;
  severity: AlertSeverity;
  channels: NotificationChannel[];
  cooldown: number;
  enabled: boolean;
}
```

**告警级别**:
- **Critical**: 严重告警，需要立即处理
- **Error**: 错误告警，需要及时处理
- **Warning**: 警告告警，需要关注
- **Info**: 信息告警，仅做记录

### 5.4 通知渠道管理
**功能描述**: 配置告警的通知渠道和通知策略。

**通知渠道**:
- **邮件通知**: SMTP邮件发送
- **短信通知**: SMS短信发送
- **Webhook**: HTTP回调通知
- **企业微信**: 企业微信机器人

**通知策略**:
- 按告警级别配置不同通知渠道
- 设置通知频率限制
- 配置通知时间窗口
- 支持通知升级策略

## 6. 系统监控

### 6.1 适配器状态监控
**功能描述**: 监控所有南向适配器的连接状态和性能指标。

**监控指标**:
- **连接状态**: 在线、离线、连接中、错误
- **数据流量**: 接收数据量、发送数据量
- **响应时间**: 平均响应时间、最大响应时间
- **错误统计**: 连接错误、数据错误、超时错误

**状态展示**:
- 设备列表状态概览
- 详细状态图表
- 历史状态趋势
- 异常状态告警

### 6.2 数据流监控
**功能描述**: 监控系统中的数据流向和处理性能。

**数据流图**:
- 数据源到目的地的流向图
- 实时数据流量显示
- 数据处理节点状态
- 数据丢失和延迟统计

**性能监控**:
- 数据处理吞吐量
- 数据处理延迟
- 缓冲区使用情况
- 错误率统计

### 6.3 连接诊断
**功能描述**: 诊断设备连接问题，提供连接测试功能。

**诊断工具**:
- **连接测试**: 测试设备连接可达性
- **协议验证**: 验证通信协议正确性
- **性能测试**: 测试连接性能和稳定性
- **故障诊断**: 自动诊断常见连接问题

**诊断报告**:
- 详细的诊断结果
- 问题原因分析
- 解决方案建议
- 历史诊断记录

### 6.4 性能分析
**功能描述**: 分析系统和设备的性能表现。

**性能指标**:
- CPU和内存使用趋势
- 网络带宽使用情况
- 数据库查询性能
- 接口响应时间分析

**分析工具**:
- 性能图表展示
- 性能瓶颈识别
- 性能优化建议
- 性能报告生成

## 7. 系统设置

### 7.1 系统配置管理
**功能描述**: 管理系统的核心配置参数。

**配置类型**:
- **基础配置**: 端口、日志级别、调试模式
- **安全配置**: 认证策略、权限设置
- **性能配置**: 缓存设置、连接池配置
- **集成配置**: 外部系统集成参数

**配置编辑**:
- 配置表单界面
- 配置验证检查
- 配置变更审计
- 配置回滚支持

### 7.2 用户信息管理
**功能描述**: 管理用户账户信息和个人设置。

**用户信息**:
- 基本信息编辑
- 密码修改
- 个人偏好设置
- 操作历史记录

**安全设置**:
- 密码强度要求
- 登录IP限制
- 会话超时设置
- 双因子认证

### 7.3 系统操作
**功能描述**: 提供系统级别的操作功能。

**系统操作**:
- **系统重启**: 安全重启系统服务
- **配置重载**: 重新加载配置文件
- **缓存清理**: 清理系统缓存
- **日志清理**: 清理历史日志文件

**操作确认**:
- 危险操作二次确认
- 操作影响说明
- 操作结果反馈
- 操作日志记录

## 8. 实时通信功能

### 8.1 WebSocket连接管理
**功能描述**: 管理前端与后端的WebSocket连接。

**连接特性**:
- 自动连接建立
- 连接断开重试
- 连接状态监控
- 心跳检测机制

**消息处理**:
```typescript
// WebSocket消息类型
type MessageType = 
  | 'system_status'
  | 'iot_data' 
  | 'rule_event'
  | 'alert'
  | 'plugin_status';

interface WSMessage {
  type: MessageType;
  data: any;
  timestamp: string;
}
```

### 8.2 实时数据更新
**功能描述**: 实时接收和处理来自系统的数据更新。

**数据类型**:
- IoT设备数据更新
- 系统状态变化
- 规则执行事件
- 告警实时推送
- 插件状态变化

**更新处理**:
- 数据去重处理
- 批量更新优化
- 界面局部刷新
- 数据缓存管理

---

此功能文档详细描述了 IoT Gateway Web UI 的所有核心功能，为用户使用和开发者维护提供了全面的功能参考。