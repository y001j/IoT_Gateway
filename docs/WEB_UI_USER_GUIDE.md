# IoT Gateway Web UI 用户使用指南

## 快速入门

### 系统要求

**浏览器要求**:
- Chrome 90+ (推荐)
- Firefox 88+
- Safari 14+
- Edge 90+

**网络要求**:
- 支持WebSocket连接
- 稳定的网络连接
- 建议使用有线网络或稳定WiFi

### 首次访问

1. **打开浏览器**，访问系统地址: `http://your-gateway-ip:8081`
2. **系统检查**: 首次访问会自动检查系统状态
3. **登录界面**: 系统会跳转到登录页面

## 登录和认证

### 登录步骤

1. **输入凭据**
   ```
   用户名: admin (默认管理员账户)
   密码: admin123 (默认密码，建议首次登录后修改)
   ```

2. **记住登录状态** (可选)
   - 勾选"记住我"可以延长登录时间
   - 适用于个人专用设备

3. **点击登录**
   - 系统验证凭据
   - 成功后跳转到仪表板

### 安全提示

⚠️ **重要安全建议**:
- 首次登录后立即修改默认密码
- 使用强密码 (至少8位，包含大小写字母、数字、特殊字符)
- 不要在公共设备上保存登录状态
- 定期更换密码

## 界面导航

### 主界面布局

```
┌─────────────────────────────────────────────────────────────┐
│                     顶部导航栏                               │
├──────────────┬──────────────────────────────────────────────┤
│              │                                              │
│   侧边导航    │              主内容区域                       │
│              │                                              │
│  - 仪表盘     │          (根据选择的菜单显示不同内容)          │
│  - 插件管理   │                                              │
│  - 规则管理   │                                              │
│  - 告警管理   │                                              │
│  - 连接监控   │                                              │
│  - 系统设置   │                                              │
│              │                                              │
└──────────────┴──────────────────────────────────────────────┘
```

### 导航菜单说明

| 菜单项 | 图标 | 功能描述 |
|--------|------|----------|
| 仪表盘 | 📊 | 系统概览和实时监控 |
| 插件管理 | 🔌 | 管理南向适配器和北向连接器 |
| 规则管理 | ⚙️ | 配置和管理数据处理规则 |
| 告警管理 | 🚨 | 查看和处理系统告警 |
| 连接监控 | 📡 | 监控设备连接状态 |
| 系统设置 | ⚙️ | 系统配置和用户设置 |

## 仪表盘使用

### 系统概览选项卡

仪表盘提供系统的整体视图，包含三个主要选项卡：

#### 1. 系统概览

**关键指标卡片**:
- **系统运行时间**: 显示系统连续运行时长
- **活跃插件**: 当前正在运行的插件数量
- **实时数据点**: 正在处理的数据点数目
- **连接状态**: WebSocket实时连接状态

**系统资源监控**:
- **CPU使用率**: 实时显示系统CPU占用
  - 绿色 (0-60%): 正常
  - 黄色 (60-80%): 注意
  - 红色 (80%+): 警告
- **内存使用率**: 系统内存占用情况
- **连接状态**: 实时连接状态和最后更新时间

**最近告警**:
- 显示最新的5条告警信息
- 按照严重程度用不同颜色标识
- 点击可查看告警详情

**插件状态**:
- 显示前8个插件的运行状态
- 绿色圆点表示运行中
- 红色圆点表示停止或错误

#### 2. 系统监控

提供详细的系统性能图表:
- **CPU使用率趋势图**: 显示一段时间内的CPU使用变化
- **内存使用趋势图**: 内存占用的历史变化
- **网络流量图**: 网络进出流量统计
- **磁盘I/O图**: 磁盘读写性能

#### 3. 数据流监控

实时IoT数据流可视化:
- **实时数据图表**: 展示IoT数据的实时变化
- **数据流量统计**: 数据吞吐量信息
- **设备状态列表**: 各设备的连接和数据状态
- **原始数据表格**: 显示最新接收的数据详情

### 操作技巧

**刷新数据**:
- 点击右上角的 🔄 "刷新数据" 按钮
- 手动刷新所有仪表盘数据

**重新连接**:
- 当WebSocket断开时，点击 "重新连接" 按钮
- 恢复实时数据推送

## 插件管理

### 插件列表查看

**插件信息展示**:
- **名称**: 插件的显示名称
- **类型**: Southbound (南向) 或 Northbound (北向)
- **状态**: Running (运行中) / Stopped (已停止) / Error (错误)
- **版本**: 插件版本号
- **描述**: 插件功能描述

**筛选和搜索**:
- 使用搜索框快速查找插件
- 按状态筛选: 全部 / 运行中 / 已停止 / 错误
- 按类型筛选: 全部 / 南向适配器 / 北向连接器

### 插件操作

#### 启动插件
1. 在插件列表中找到目标插件
2. 点击 "启动" 按钮
3. 等待操作完成，观察状态变化
4. 检查日志确认启动成功

#### 停止插件
1. 选择正在运行的插件
2. 点击 "停止" 按钮
3. 确认停止操作 (会出现确认对话框)
4. 等待插件安全停止

#### 重启插件
1. 对于需要重启的插件
2. 点击 "重启" 按钮
3. 系统会先停止再启动插件
4. 监控重启过程和结果

### 插件配置管理

#### 查看配置
1. 点击插件行的 "详情" 按钮
2. 在弹出的详情窗口中选择 "配置" 选项卡
3. 查看当前配置的JSON格式

#### 编辑配置 (管理员权限)
1. 在配置选项卡中点击 "编辑配置"
2. 使用内置的JSON编辑器修改配置
3. 编辑器提供语法高亮和错误检查
4. 修改完成后点击 "保存" 按钮
5. 系统会验证配置格式和内容

**配置编辑器功能**:
- 语法高亮显示
- 自动格式化
- 错误行标记
- 自动补全提示

#### 配置验证
- 保存前自动进行语法验证
- 检查必填字段
- 验证数据类型
- 检查配置逻辑合理性

### 插件日志查看

#### 访问日志
1. 在插件详情窗口选择 "日志" 选项卡
2. 选择日志级别 (Debug / Info / Warn / Error)
3. 查看实时或历史日志

#### 日志功能
- **实时更新**: 显示最新的日志条目
- **级别过滤**: 按严重程度筛选日志
- **搜索功能**: 关键词搜索特定日志
- **下载日志**: 导出日志文件到本地

## 规则管理

### 规则概述

规则引擎允许你配置数据处理逻辑，包括数据过滤、转换、告警等功能。

### 查看规则列表

**规则信息**:
- **规则名称**: 规则的标识名称
- **状态**: 启用 (绿色) / 禁用 (灰色)
- **条件摘要**: 触发条件的简要描述
- **动作摘要**: 执行动作的简要描述
- **执行次数**: 规则被触发的次数

### 创建新规则

#### 1. 基本信息设置
```
规则名称: 温度超限告警
描述: 当温度传感器读数超过35度时发送告警
优先级: 高 (1-10，数字越小优先级越高)
```

#### 2. 配置触发条件

**简单条件示例**:
```json
{
  "type": "simple",
  "field": "temperature",
  "operator": "gt",
  "value": 35
}
```

**复合条件示例**:
```json
{
  "type": "and",
  "conditions": [
    {
      "type": "simple",
      "field": "temperature",
      "operator": "gt", 
      "value": 35
    },
    {
      "type": "simple",
      "field": "device_type",
      "operator": "eq",
      "value": "sensor"
    }
  ]
}
```

#### 3. 配置执行动作

**告警动作示例**:
```json
{
  "type": "alert",
  "config": {
    "level": "error",
    "title": "温度超限",
    "message": "设备 {{device_id}} 温度达到 {{temperature}}°C",
    "channels": ["email", "webhook"]
  }
}
```

**数据转换动作示例**:
```json
{
  "type": "transform",
  "config": {
    "operations": [
      {
        "type": "scale",
        "field": "temperature",
        "factor": 1.8,
        "offset": 32
      }
    ]
  }
}
```

### 规则管理操作

#### 启用/禁用规则
- 使用规则列表中的开关按钮
- 禁用的规则不会执行
- 支持批量启用/禁用

#### 测试规则
1. 在规则编辑页面点击 "测试规则"
2. 输入测试数据
3. 查看规则执行结果
4. 验证条件判断和动作执行

#### 复制规则
1. 选择要复制的规则
2. 点击 "复制" 按钮
3. 修改规则名称和其他参数
4. 保存新规则

## 告警管理

### 告警查看

#### 告警列表
- **时间排序**: 最新告警显示在顶部
- **级别标识**: 用颜色区分告警严重程度
  - 🔴 Critical: 严重告警
  - 🟠 Error: 错误告警  
  - 🟡 Warning: 警告告警
  - 🔵 Info: 信息告警

#### 告警详情
点击告警条目查看详细信息:
- 告警标题和描述
- 产生时间和来源
- 相关设备或插件信息
- 告警参数和上下文数据

### 告警处理

#### 确认告警
1. 选择需要确认的告警
2. 点击 "确认" 按钮
3. 添加确认备注 (可选)
4. 告警状态变为 "已确认"

#### 解决告警
1. 在确认告警后，解决实际问题
2. 点击 "解决" 按钮
3. 添加解决方案描述
4. 告警状态变为 "已解决"

#### 批量操作
- 选择多个告警 (使用复选框)
- 选择批量操作: 确认 / 解决 / 忽略
- 添加批量操作备注
- 确认执行批量操作

### 告警配置

#### 告警规则配置
1. 点击 "告警规则" 选项卡
2. 设置告警触发条件
3. 配置告警级别和消息模板
4. 选择通知渠道
5. 保存告警规则

#### 通知渠道配置
支持的通知方式:
- **邮件通知**: 配置SMTP服务器
- **Webhook**: HTTP回调通知
- **企业微信**: 机器人消息推送

## 连接监控

### 适配器状态监控

#### 状态概览
- **在线设备数**: 当前连接的设备数量
- **离线设备数**: 断开连接的设备数量  
- **连接错误数**: 连接异常的设备数量
- **数据流量**: 实时数据传输量

#### 设备详情
每个设备显示:
- **连接状态**: 在线 / 离线 / 连接中 / 错误
- **最后通信时间**: 最后一次数据交换时间
- **数据接收量**: 接收的数据包数量
- **错误统计**: 连接错误次数

### 连接诊断

#### 连接测试
1. 选择要测试的设备或适配器
2. 点击 "连接测试" 按钮
3. 系统执行连接测试
4. 查看测试结果和诊断信息

#### 性能测试
- **延迟测试**: 测量通信延迟
- **吞吐量测试**: 测试数据传输能力
- **稳定性测试**: 测试连接稳定性

### 数据流监控

#### 实时数据流
- 可视化数据流向图
- 显示数据处理节点
- 标识数据流量大小
- 高亮异常节点

#### 流量统计
- 按时间统计数据流量
- 按设备统计数据量
- 按协议统计传输量
- 错误率和丢包率统计

## 系统设置

### 用户信息管理

#### 修改个人信息
1. 点击右上角用户名
2. 选择 "个人设置"
3. 修改用户名、邮箱等信息
4. 保存更改

#### 修改密码
1. 在个人设置中选择 "修改密码"
2. 输入当前密码
3. 输入新密码并确认
4. 保存新密码

**密码要求**:
- 最少8个字符
- 包含大小写字母
- 包含数字
- 包含特殊字符

### 系统配置 (管理员)

#### 基础配置
- **系统名称**: 自定义系统标题
- **日志级别**: Debug / Info / Warn / Error
- **会话超时**: 用户会话超时时间
- **最大连接数**: 并发连接数限制

#### 安全配置
- **JWT密钥**: Token签名密钥
- **密码策略**: 密码复杂度要求
- **登录限制**: 失败登录次数限制
- **IP白名单**: 允许访问的IP地址

#### 集成配置
- **NATS配置**: 消息总线连接参数
- **数据库配置**: 数据库连接设置
- **邮件服务**: SMTP邮件服务配置

### 系统操作

#### 重启系统
⚠️ **注意**: 重启会中断所有连接和数据处理

1. 在系统设置中点击 "重启系统"
2. 确认重启操作 (需要管理员权限)
3. 系统执行安全关闭流程
4. 等待系统重新启动

#### 配置备份
1. 点击 "备份配置" 按钮
2. 系统生成配置文件压缩包
3. 下载备份文件到本地
4. 妥善保存备份文件

#### 配置恢复
1. 点击 "恢复配置" 按钮
2. 选择备份文件上传
3. 确认恢复操作
4. 系统应用备份配置

## 常见问题解决

### 连接问题

**Q: WebSocket连接经常断开**
A: 
1. 检查网络稳定性
2. 确认防火墙设置
3. 增加连接超时时间
4. 使用有线网络连接

**Q: 无法登录系统**
A:
1. 确认用户名密码正确
2. 检查账户是否被锁定
3. 清除浏览器缓存
4. 确认系统服务正常运行

### 性能问题

**Q: 页面加载缓慢**
A:
1. 检查网络连接速度
2. 清除浏览器缓存
3. 减少同时打开的选项卡
4. 升级浏览器到最新版本

**Q: 实时数据不更新**
A:
1. 检查WebSocket连接状态
2. 确认数据源正常
3. 重新连接WebSocket
4. 检查插件运行状态

### 配置问题

**Q: 插件配置保存失败**
A:
1. 检查JSON格式是否正确
2. 确认必填字段已填写
3. 验证配置参数合理性
4. 检查权限设置

**Q: 规则不执行**
A:
1. 确认规则已启用
2. 检查触发条件设置
3. 验证数据源连接
4. 查看规则执行日志

## 最佳实践

### 日常维护
1. **定期检查告警**: 每日查看告警情况
2. **监控系统性能**: 关注CPU、内存使用
3. **备份配置**: 定期备份系统配置
4. **更新密码**: 定期更换登录密码

### 性能优化
1. **限制历史数据**: 设置合理的数据保留期
2. **优化规则**: 避免过于复杂的规则条件
3. **监控资源**: 及时清理无用的插件和规则
4. **网络优化**: 使用稳定的网络连接

### 安全建议
1. **访问控制**: 限制不必要的用户访问
2. **定期审计**: 检查用户操作日志
3. **网络安全**: 使用HTTPS和防火墙
4. **密码管理**: 使用强密码和定期更换

---

本用户指南提供了 IoT Gateway Web UI 的完整使用说明，帮助用户快速掌握系统的各项功能和操作方法。如有其他问题，请参考系统帮助文档或联系技术支持。