# è§„åˆ™å¼•æ“ä¼˜åŒ–æµ‹è¯•é…ç½®
gateway:
  data_port: 4222
  web_port: 8081
  log_level: "info"
  nats_url: "nats://localhost:4222"
  plugins_dir: "./plugins"
  embedded_nats: true

# ğŸ†• ä¼˜åŒ–åçš„è§„åˆ™å¼•æ“é…ç½®
rule_engine:
  enabled: true
  rules_dir: "./rules"
  
  # ğŸš€ å·¥ä½œæ± é…ç½®ï¼ˆæ–°å¢ï¼‰
  worker_pool:
    size: 8                    # å¹¶è¡Œå·¥ä½œçº¿ç¨‹æ•°
    queue_size: 1000          # ä»»åŠ¡é˜Ÿåˆ—å¤§å°
    batch_size: 50            # æ‰¹å¤„ç†å¤§å°
    batch_timeout: "100ms"    # æ‰¹å¤„ç†è¶…æ—¶
    
  # ğŸš€ å¯¹è±¡æ± ä¼˜åŒ–ï¼ˆæ–°å¢ï¼‰
  object_pools:
    enabled: true             # å¯ç”¨å¯¹è±¡æ± 
    point_batch_pool: 100     # æ•°æ®ç‚¹æ‰¹æ¬¡æ± å¤§å°
    json_buffer_pool: 200     # JSONç¼“å†²åŒºæ± å¤§å°
    device_map_pool: 50       # è®¾å¤‡æ˜ å°„æ± å¤§å°
    
  # ğŸš€ èšåˆä¼˜åŒ–é…ç½®ï¼ˆæ–°å¢ï¼‰
  aggregation:
    enable_incremental: true   # å¯ç”¨å¢é‡ç»Ÿè®¡
    state_cleanup_interval: "5m"  # çŠ¶æ€æ¸…ç†é—´éš”
    max_states: 10000         # æœ€å¤§èšåˆçŠ¶æ€æ•°
    default_ttl: "10m"        # é»˜è®¤TTL
    
  # ğŸš€ NATSä¼˜åŒ–ï¼ˆæ–°å¢ï¼‰
  nats:
    batch_publish: true       # æ‰¹é‡å‘å¸ƒ
    batch_size: 100          # æ‰¹é‡å¤§å°
    flush_timeout: "10ms"    # åˆ·æ–°è¶…æ—¶
    async_publish: true      # å¼‚æ­¥å‘å¸ƒ
    
  # ç¼“å­˜é…ç½®
  cache:
    rules:
      size: 5000             # è§„åˆ™ç¼“å­˜å¤§å°
      ttl: "30m"            # è§„åˆ™ç¼“å­˜TTL
    plugin_metadata:
      size: 1000             # æ’ä»¶å…ƒæ•°æ®ç¼“å­˜
      ttl: "1h"             # å…ƒæ•°æ®ç¼“å­˜TTL
      
  # ğŸ†• ç›‘æ§é…ç½®ï¼ˆæ–°å¢ï¼‰
  monitoring:
    enabled: true
    metrics_retention: "24h"  # æŒ‡æ ‡ä¿ç•™æ—¶é—´
    error_retention: "7d"     # é”™è¯¯ä¿ç•™æ—¶é—´
    health_check_interval: "30s"  # å¥åº·æ£€æŸ¥é—´éš”

# Southboundé€‚é…å™¨é…ç½®
southbound:
  adapters:
    - name: "mock-test-adapter"
      type: "mock"
      enabled: true
      config:
        device_id: "test-device-optimized"
        interval_ms: 100  # é«˜é¢‘ç‡æµ‹è¯•
        points:
          - key: "temperature"
            min: 20.0
            max: 40.0
            type: "float"
            variance: 0.1
          - key: "humidity" 
            min: 30.0
            max: 70.0
            type: "float"
            variance: 0.05
          - key: "pressure"
            min: 950.0
            max: 1050.0
            type: "float"
            variance: 0.02
          - key: "voltage"
            min: 3.0
            max: 5.0
            type: "float"
            variance: 0.01
          - key: "status"
            min: 0
            max: 1
            type: "int"
            variance: 0.1

# Northboundæ¥æ”¶å™¨é…ç½®
northbound:
  sinks:
    - name: "console-test-sink"
      type: "console"
      enabled: true
      config:
        format: "json"
        timestamp: true
        
    - name: "websocket-test-sink"
      type: "websocket"
      enabled: true
      config:
        path: "/ws/data"
        buffer_size: 1000
        heartbeat_interval: "30s"

# Web UIé…ç½®
web_ui:
  enabled: true
  port: 8081
  static_dir: "./web/frontend/dist"
  auth:
    enabled: false  # æµ‹è¯•æ—¶ç¦ç”¨è®¤è¯
  cors:
    enabled: true
    origins: ["*"]