import{r as e,k as t}from"./react-vendor-XKB30K_c.js";import{b as s}from"./index-SZKmSCox.js";import{u as r}from"./useRealTimeData-Cyo8mKv8.js";import"./echarts-vendor-D7t-5Co9.js";import{aj as a,R as n,N as l,ap as i,ak as o,B as c,an as d,al as h,av as u,ar as x,ao as m,at as p,a4 as j,au as y,ay as g,aq as f,ab as _,T as v}from"./antd-vendor-BEPv5fMA.js";import{S}from"./antd-select-B9qIJAZm.js";import{Z as b,a8 as k,$ as w,_ as z,a1 as $,Y as I,X as C,O as M,a2 as R,a0 as F,a9 as L,aa as U,ab as A}from"./antd-icons-Cd9MHNVc.js";import{cN as B}from"./echarts-core-DHH3aYep.js";import{F as D}from"./antd-table-PbtM5e6h.js";import"./vendor-CG-KndAb.js";import"./utils-vendor-DHyCJoYc.js";import"./state-vendor-DvJGcyIt.js";import"./antd-date-picker-BA1qR6od.js";import"./antd-form-D97X3GMQ.js";import"./echarts-charts-BwTN3nNH.js";import"./echarts-components-qRndAGwt.js";import"./antd-tree-U-o4Fj3K.js";const T=new class{baseUrl="/api/v1/monitoring";async getAdapterStatus(){return(await s.get(`${this.baseUrl}/adapters/status`)).data.data}async getDataFlowMetrics(e){const t=new URLSearchParams;e?.time_range&&t.append("time_range",e.time_range),e?.limit&&t.append("limit",e.limit.toString());const r=`${this.baseUrl}/adapters/data-flow${t.toString()?`?${t.toString()}`:""}`;return(await s.get(r)).data.data}async getAdapterDiagnostics(e){return(await s.get(`${this.baseUrl}/adapters/${encodeURIComponent(e)}/diagnostics`)).data.data}async testAdapterConnection(e){return(await s.post(`${this.baseUrl}/adapters/${encodeURIComponent(e)}/test-connection`)).data}async getAdapterPerformance(e,t){const r=new URLSearchParams;t&&r.append("period",t);const a=`${this.baseUrl}/adapters/${encodeURIComponent(e)}/performance${r.toString()?`?${r.toString()}`:""}`;return(await s.get(a)).data}async restartAdapter(e){await s.post(`${this.baseUrl}/adapters/${encodeURIComponent(e)}/restart`)}formatUptime(e){if(e<60)return`${Math.floor(e)}秒`;if(e<3600){return`${Math.floor(e/60)}分钟`}if(e<86400){return`${Math.floor(e/3600)}小时${Math.floor(e%3600/60)}分钟`}return`${Math.floor(e/86400)}天${Math.floor(e%86400/3600)}小时`}formatBytes(e){if(0===e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return`${parseFloat((e/Math.pow(1024,t)).toFixed(1))} ${["B","KB","MB","GB","TB"][t]}`}formatNumber(e,t=1){return e>=1e6?`${(e/1e6).toFixed(t)}M`:e>=1e3?`${(e/1e3).toFixed(t)}K`:e.toFixed(t)}formatLatency(e){return e<1?`${(1e3*e).toFixed(0)}μs`:e<1e3?`${e.toFixed(1)}ms`:`${(e/1e3).toFixed(2)}s`}getStatusColor(e){switch(e){case"running":return"success";case"stopped":default:return"default";case"error":return"error"}}getHealthColor(e){switch(e){case"healthy":return"success";case"degraded":return"warning";case"unhealthy":return"error";default:return"default"}}getStatusText(e){switch(e){case"running":return"运行中";case"stopped":return"已停止";case"error":return"错误";default:return"未知"}}getHealthText(e){switch(e){case"healthy":return"健康";case"degraded":return"降级";case"unhealthy":return"不健康";default:return"未知"}}calculateHealthScore(e){let t=100;if("error"===e.status?t-=50:"stopped"===e.status&&(t-=30),"unhealthy"===e.health?t-=30:"degraded"===e.health&&(t-=15),e.data_points_count>0){t-=20*(e.errors_count/e.data_points_count)}return e.response_time_ms>1e3?t-=10:e.response_time_ms>500&&(t-=5),Math.max(0,Math.min(100,t))}getAdapterIcon(e){switch(e.toLowerCase()){case"modbus":return"🔌";case"mqtt":return"📡";case"http":return"🌐";case"mock":return"🎭";default:return"📱"}}getSinkIcon(e){switch(e.toLowerCase()){case"mqtt":return"📡";case"influxdb":return"📊";case"redis":return"🔄";case"console":return"💻";case"websocket":return"🔗";case"jetstream":return"🚀";default:return"📤"}}},H=[{value:"1h",label:"过去1小时"},{value:"6h",label:"过去6小时"},{value:"12h",label:"过去12小时"},{value:"24h",label:"过去24小时"},{value:"7d",label:"过去7天"}],{Option:E}=S,{Text:O}=o,K=({height:s=400,autoRefresh:r=!0,refreshInterval:o=1e4})=>{const[u,x]=e.useState({time:[],throughput:[],latency:[],errorRate:[],devices:[]}),[m,p]=e.useState(!1),[j,y]=e.useState("1h"),[g,f]=e.useState("line"),[,_]=e.useState(null),v=e.useRef(null),z=e.useRef(null),$=e.useRef(null),I=e.useRef(null),C=e.useRef(null),M=e.useRef(null),R=e.useRef(null),F=e.useRef(null),L=async()=>{try{p(!0),_(null);const e=new Date,t=new Date;switch(j){case"1h":t.setHours(e.getHours()-1);break;case"6h":t.setHours(e.getHours()-6);break;case"12h":t.setHours(e.getHours()-12);break;case"24h":t.setDate(e.getDate()-1);break;case"7d":t.setDate(e.getDate()-7)}const s=await T.getDataFlowMetrics({time_range:j,limit:100}),r=U(s.metrics||[]);x(r)}catch(e){console.error("获取数据流指标失败:",e),_(e instanceof Error?e.message:"未知错误")}finally{p(!1)}},U=e=>{const t=new Date,s=[],r=[],a=[],n=[];for(let i=23;i>=0;i--){const e=new Date(t.getTime()-3e5*i);s.push(e.toISOString()),r.push(Math.floor(100*Math.random())+50),a.push(Math.floor(50*Math.random())+10),n.push(5*Math.random())}const l=new Map;e.forEach(e=>{const t=l.get(e.device_id)||0;l.set(e.device_id,t+1)});return{time:s,throughput:r,latency:a,errorRate:n,devices:Array.from(l.entries()).map(([e,t])=>({name:e,value:t}))}},A=()=>{C.current?.resize(),M.current?.resize(),R.current?.resize(),F.current?.resize()};e.useEffect(()=>(v.current&&(C.current=B(v.current)),z.current&&(M.current=B(z.current)),$.current&&(R.current=B($.current)),I.current&&(F.current=B(I.current)),L(),window.addEventListener("resize",A),()=>{window.removeEventListener("resize",A),C.current?.dispose(),M.current?.dispose(),R.current?.dispose(),F.current?.dispose()}),[]),e.useEffect(()=>{(()=>{if(C.current){const e={title:{text:"数据吞吐量",left:"center",textStyle:{fontSize:14}},tooltip:{trigger:"axis",formatter:"{b}<br/>吞吐量: {c} 点/秒"},xAxis:{type:"category",data:u.time,axisLabel:{fontSize:10}},yAxis:{type:"value",name:"点/秒",axisLabel:{fontSize:10}},series:[{data:u.throughput,type:g,smooth:!0,areaStyle:"line"===g?{opacity:.3}:void 0,itemStyle:{color:"#1890ff"}}],grid:{left:60,right:20,top:50,bottom:40}};C.current.setOption(e)}if(M.current){const e={title:{text:"网络延迟",left:"center",textStyle:{fontSize:14}},tooltip:{trigger:"axis",formatter:"{b}<br/>延迟: {c} ms"},xAxis:{type:"category",data:u.time,axisLabel:{fontSize:10}},yAxis:{type:"value",name:"毫秒",axisLabel:{fontSize:10}},series:[{data:u.latency,type:g,smooth:!0,areaStyle:"line"===g?{opacity:.3}:void 0,itemStyle:{color:"#52c41a"}}],grid:{left:60,right:20,top:50,bottom:40}};M.current.setOption(e)}if(R.current){const e={title:{text:"错误率",left:"center",textStyle:{fontSize:14}},tooltip:{trigger:"axis",formatter:"{b}<br/>错误率: {c}%"},xAxis:{type:"category",data:u.time,axisLabel:{fontSize:10}},yAxis:{type:"value",name:"%",max:100,axisLabel:{fontSize:10}},series:[{data:u.errorRate.map(e=>(100*e).toFixed(2)),type:g,smooth:!0,areaStyle:"line"===g?{opacity:.3}:void 0,itemStyle:{color:"#f5222d"}}],grid:{left:60,right:20,top:50,bottom:40}};R.current.setOption(e)}if(F.current){const e={title:{text:"设备数据分布",left:"center",textStyle:{fontSize:14}},tooltip:{trigger:"item",formatter:"{a}<br/>{b}: {c} ({d}%)"},legend:{bottom:10,left:"center",textStyle:{fontSize:10}},series:[{name:"设备数据量",type:"pie",radius:["40%","70%"],center:["50%","45%"],avoidLabelOverlap:!1,label:{show:!1},emphasis:{label:{show:!0,fontSize:12,fontWeight:"bold"}},data:u.devices}]};F.current.setOption(e)}})()},[u,g]),e.useEffect(()=>{L()},[j]),e.useEffect(()=>{if(!r)return;const e=setInterval(L,o);return()=>clearInterval(e)},[r,o,j]);const D=u.throughput.reduce((e,t)=>e+t,0),K=u.latency.reduce((e,t)=>e+t,0)/u.latency.length,N=u.errorRate.reduce((e,t)=>e+t,0)/u.errorRate.length,q=u.devices.length;return t.jsxs("div",{children:[t.jsx(a,{size:"small",style:{marginBottom:16},children:t.jsxs(n,{gutter:16,align:"middle",children:[t.jsx(l,{children:t.jsxs(i,{children:[t.jsx(O,{children:"时间范围:"}),t.jsx(S,{value:j,onChange:y,style:{width:120},children:H.map(e=>t.jsx(E,{value:e.value,children:e.label},e.value))})]})}),t.jsx(l,{children:t.jsxs(i,{children:[t.jsx(O,{children:"图表类型:"}),t.jsxs(S,{value:g,onChange:f,style:{width:100},children:[t.jsxs(E,{value:"line",children:[t.jsx(b,{})," 折线图"]}),t.jsxs(E,{value:"bar",children:[t.jsx(k,{})," 柱状图"]})]})]})}),t.jsx(l,{children:t.jsx(c,{icon:t.jsx(w,{}),onClick:L,loading:m,children:"刷新"})})]})}),t.jsxs(n,{gutter:[16,16],style:{marginBottom:16},children:[t.jsx(l,{xs:24,sm:6,children:t.jsx(a,{size:"small",children:t.jsx(d,{title:"总吞吐量",value:D.toFixed(1),suffix:"点/秒",valueStyle:{color:"#1890ff",fontSize:"18px"}})})}),t.jsx(l,{xs:24,sm:6,children:t.jsx(a,{size:"small",children:t.jsx(d,{title:"平均延迟",value:K.toFixed(1),suffix:"ms",valueStyle:{color:"#52c41a",fontSize:"18px"}})})}),t.jsx(l,{xs:24,sm:6,children:t.jsx(a,{size:"small",children:t.jsx(d,{title:"错误率",value:(100*N).toFixed(2),suffix:"%",valueStyle:{color:N>.05?"#f5222d":"#52c41a",fontSize:"18px"}})})}),t.jsx(l,{xs:24,sm:6,children:t.jsx(a,{size:"small",children:t.jsx(d,{title:"活跃设备",value:q,suffix:"个",valueStyle:{color:"#722ed1",fontSize:"18px"}})})})]}),t.jsxs(n,{gutter:[16,16],children:[t.jsx(l,{xs:24,lg:12,children:t.jsx(a,{size:"small",children:t.jsx("div",{ref:v,style:{height:s/2}})})}),t.jsx(l,{xs:24,lg:12,children:t.jsx(a,{size:"small",children:t.jsx("div",{ref:z,style:{height:s/2}})})}),t.jsx(l,{xs:24,lg:12,children:t.jsx(a,{size:"small",children:t.jsx("div",{ref:$,style:{height:s/2}})})}),t.jsx(l,{xs:24,lg:12,children:t.jsx(a,{size:"small",children:t.jsx("div",{ref:I,style:{height:s/2}})})})]}),0===u.devices.length&&!m&&t.jsx(h,{message:"暂无数据流数据",description:"当前没有检测到数据流活动，请检查适配器是否正在运行并产生数据。",type:"info",showIcon:!0,style:{marginTop:16}})]})},N=[{label:"5分钟",value:"5m"},{label:"15分钟",value:"15m"},{label:"1小时",value:"1h"},{label:"6小时",value:"6h"},{label:"24小时",value:"24h"},{label:"7天",value:"7d"}],{Title:q,Text:P}=o,{Option:W}=S,G=()=>{const[s,o]=e.useState(!0),[k,B]=e.useState([]),[H,E]=e.useState([]),[O,G]=e.useState(null),[J,X]=e.useState([]),[Y,Z]=e.useState("1h"),[Q,V]=e.useState(null),[ee,te]=e.useState(null),[se,re]=e.useState(!1),[ae,ne]=e.useState("overview"),{data:le,isConnected:ie}=r({autoConnect:!0,enableSystemUpdates:!0}),oe=async()=>{try{o(!0);const[e,t]=await Promise.all([T.getAdapterStatus(),T.getDataFlowMetrics({time_range:Y})]);B(e.adapters),E(e.sinks),G(e.overview),X(t.metrics)}catch(e){u.error("加载监控数据失败: "+e.message)}finally{o(!1)}},ce=async()=>{await oe(),u.success("数据已刷新")};e.useEffect(()=>{oe()},[]),e.useEffect(()=>{Y&&T.getDataFlowMetrics({time_range:Y}).then(e=>X(e.metrics)).catch(e=>u.error("更新数据流失败: "+e.message))},[Y]),e.useEffect(()=>{},[le,ie]);const de=[{title:"名称",dataIndex:"name",key:"name",render:(e,s)=>t.jsxs(i,{children:[t.jsx("span",{style:{fontSize:"16px"},children:T.getAdapterIcon(s.type)}),t.jsx(P,{strong:!0,children:e})]})},{title:"类型",dataIndex:"type",key:"type",render:e=>t.jsx(f,{children:e.toUpperCase()})},{title:"状态",dataIndex:"status",key:"status",render:e=>t.jsx(p,{status:T.getStatusColor(e),text:T.getStatusText(e)})},{title:"健康状态",dataIndex:"health",key:"health",render:(e,s)=>t.jsx(v,{title:s.health_message,children:t.jsx(f,{color:T.getHealthColor(e),children:T.getHealthText(e)})})},{title:"运行时间",dataIndex:"connection_uptime",key:"connection_uptime",render:e=>T.formatUptime(e)},{title:"数据点",dataIndex:"data_points_count",key:"data_points_count",render:e=>T.formatNumber(e)},{title:"错误数",dataIndex:"errors_count",key:"errors_count",render:(e,s)=>{const r=s.data_points_count>0?(e/s.data_points_count*100).toFixed(2):"0";return t.jsx(v,{title:`错误率: ${r}%`,children:t.jsx(P,{type:e>0?"danger":"secondary",children:e})})}},{title:"响应时间",dataIndex:"response_time_ms",key:"response_time_ms",render:e=>T.formatLatency(e)},{title:"操作",key:"actions",render:(e,s)=>t.jsxs(i,{size:"small",children:[t.jsx(v,{title:"测试连接",children:t.jsx(c,{size:"small",icon:t.jsx(L,{}),onClick:()=>(async e=>{try{const t=await T.testAdapterConnection(e);t.success?u.success(`${e} 连接测试成功`):u.error(`${e} 连接测试失败: ${t.error}`)}catch(t){u.error("连接测试失败: "+t.message)}})(s.name),disabled:"running"!==s.status})}),t.jsx(v,{title:"诊断",children:t.jsx(c,{size:"small",icon:t.jsx(U,{}),onClick:()=>(async e=>{try{V(e);const t=await T.getAdapterDiagnostics(e);te(t),re(!0)}catch(t){u.error("获取诊断信息失败: "+t.message)}})(s.name)})}),t.jsx(v,{title:"重启",children:t.jsx(c,{size:"small",icon:t.jsx(A,{}),onClick:()=>(async e=>{g.confirm({title:"确认重启",content:`确定要重启适配器 "${e}" 吗？`,onOk:async()=>{try{await T.restartAdapter(e),u.success("重启请求已提交"),setTimeout(oe,2e3)}catch(t){u.error("重启失败: "+t.message)}}})})(s.name),disabled:"stopped"===s.status,danger:!0})})]})}],he=[{title:"名称",dataIndex:"name",key:"name",render:(e,s)=>t.jsxs(i,{children:[t.jsx("span",{style:{fontSize:"16px"},children:T.getSinkIcon(s.type)}),t.jsx(P,{strong:!0,children:e})]})},{title:"类型",dataIndex:"type",key:"type",render:e=>t.jsx(f,{children:e.toUpperCase()})},{title:"状态",dataIndex:"status",key:"status",render:e=>t.jsx(p,{status:T.getStatusColor(e),text:T.getStatusText(e)})},{title:"健康状态",dataIndex:"health",key:"health",render:(e,s)=>t.jsx(v,{title:s.health_message,children:t.jsx(f,{color:T.getHealthColor(e),children:T.getHealthText(e)})})},{title:"运行时间",dataIndex:"connection_uptime",key:"connection_uptime",render:e=>T.formatUptime(e)},{title:"消息发布",dataIndex:"messages_published",key:"messages_published",render:e=>T.formatNumber(e)},{title:"错误数",dataIndex:"errors_count",key:"errors_count",render:e=>t.jsx(P,{type:e>0?"danger":"secondary",children:e})},{title:"响应时间",dataIndex:"response_time_ms",key:"response_time_ms",render:e=>T.formatLatency(e)}],ue=[{title:"适配器",dataIndex:"adapter_name",key:"adapter_name",render:e=>t.jsx(P,{strong:!0,children:e})},{title:"设备ID",dataIndex:"device_id",key:"device_id"},{title:"数据键",dataIndex:"key",key:"key"},{title:"数据点/秒",dataIndex:"data_points_per_sec",key:"data_points_per_sec",render:e=>t.jsx(P,{children:e.toFixed(1)})},{title:"字节/秒",dataIndex:"bytes_per_sec",key:"bytes_per_sec",render:e=>T.formatBytes(e)},{title:"延迟",dataIndex:"latency_ms",key:"latency_ms",render:e=>T.formatLatency(e)},{title:"错误率",dataIndex:"error_rate",key:"error_rate",render:e=>t.jsxs(P,{type:e>.05?"danger":"secondary",children:[(100*e).toFixed(2),"%"]})},{title:"最后数值",dataIndex:"last_value",key:"last_value",render:e=>t.jsx(P,{code:!0,style:{fontSize:"12px"},children:JSON.stringify(e).substring(0,20)})}],xe=[{key:"overview",label:t.jsxs("span",{children:[t.jsx(M,{}),"系统概览"]}),children:t.jsxs("div",{children:[O&&t.jsxs(n,{gutter:[24,24],style:{marginBottom:24},children:[t.jsx(l,{xs:24,sm:12,lg:6,children:t.jsx(a,{children:t.jsx(d,{title:"系统健康",value:O.system_health,prefix:(e=>{switch(e){case"healthy":return t.jsx(F,{style:{color:"#52c41a"}});case"degraded":return t.jsx($,{style:{color:"#faad14"}});case"unhealthy":return t.jsx(R,{style:{color:"#f5222d"}});default:return t.jsx(M,{style:{color:"#d9d9d9"}})}})(O.system_health),valueStyle:{color:"healthy"===O.system_health?"#52c41a":"degraded"===O.system_health?"#faad14":"#f5222d"}})})}),t.jsx(l,{xs:24,sm:12,lg:6,children:t.jsx(a,{children:t.jsx(d,{title:"活跃连接",value:O.active_connections,prefix:t.jsx(z,{}),suffix:`/ ${O.total_adapters+O.total_sinks}`,valueStyle:{color:"#1890ff"}})})}),t.jsx(l,{xs:24,sm:12,lg:6,children:t.jsx(a,{children:t.jsx(d,{title:"数据点/秒",value:O.total_data_points_per_sec.toFixed(1),prefix:t.jsx(b,{}),valueStyle:{color:"#722ed1"}})})}),t.jsx(l,{xs:24,sm:12,lg:6,children:t.jsx(a,{children:t.jsx(d,{title:"错误/秒",value:O.total_errors_per_sec.toFixed(2),prefix:t.jsx($,{}),valueStyle:{color:O.total_errors_per_sec>0?"#f5222d":"#52c41a"}})})})]}),O&&t.jsxs(n,{gutter:[24,24],children:[t.jsx(l,{xs:24,lg:12,children:t.jsxs(a,{title:"适配器状态",size:"small",children:[t.jsxs(n,{gutter:16,children:[t.jsx(l,{span:8,children:t.jsx(d,{title:"总数",value:O.total_adapters,prefix:t.jsx(I,{})})}),t.jsx(l,{span:8,children:t.jsx(d,{title:"运行中",value:O.running_adapters,valueStyle:{color:"#1890ff"}})}),t.jsx(l,{span:8,children:t.jsx(d,{title:"健康",value:O.healthy_adapters,valueStyle:{color:"#52c41a"}})})]}),t.jsx(x,{}),t.jsx(m,{percent:O.total_adapters>0?O.healthy_adapters/O.total_adapters*100:0,strokeColor:"#52c41a",format:()=>`${O.healthy_adapters}/${O.total_adapters} 健康`})]})}),t.jsx(l,{xs:24,lg:12,children:t.jsxs(a,{title:"连接器状态",size:"small",children:[t.jsxs(n,{gutter:16,children:[t.jsx(l,{span:8,children:t.jsx(d,{title:"总数",value:O.total_sinks,prefix:t.jsx(C,{})})}),t.jsx(l,{span:8,children:t.jsx(d,{title:"运行中",value:O.running_sinks,valueStyle:{color:"#1890ff"}})}),t.jsx(l,{span:8,children:t.jsx(d,{title:"健康",value:O.healthy_sinks,valueStyle:{color:"#52c41a"}})})]}),t.jsx(x,{}),t.jsx(m,{percent:O.total_sinks>0?O.healthy_sinks/O.total_sinks*100:0,strokeColor:"#52c41a",format:()=>`${O.healthy_sinks}/${O.total_sinks} 健康`})]})})]})]})},{key:"adapters",label:t.jsxs("span",{children:[t.jsx(I,{}),"适配器监控",k.filter(e=>"error"===e.status).length>0&&t.jsx(p,{count:k.filter(e=>"error"===e.status).length,style:{marginLeft:8}})]}),children:t.jsx(a,{children:t.jsx(D,{columns:de,dataSource:k,rowKey:"name",loading:s,pagination:{pageSize:10},scroll:{x:1200}})})},{key:"sinks",label:t.jsxs("span",{children:[t.jsx(C,{}),"连接器监控",H.filter(e=>"error"===e.status).length>0&&t.jsx(p,{count:H.filter(e=>"error"===e.status).length,style:{marginLeft:8}})]}),children:t.jsx(a,{children:t.jsx(D,{columns:he,dataSource:H,rowKey:"name",loading:s,pagination:{pageSize:10},scroll:{x:1e3}})})},{key:"dataflow",label:t.jsxs("span",{children:[t.jsx(b,{}),"数据流监控"]}),children:t.jsxs("div",{children:[t.jsx(K,{height:400,autoRefresh:!0,refreshInterval:1e4}),t.jsxs(a,{title:"数据流详情",style:{marginTop:16},children:[t.jsx("div",{style:{marginBottom:16},children:t.jsxs(i,{children:[t.jsx(P,{children:"时间范围:"}),t.jsx(S,{value:Y,onChange:Z,style:{width:120},children:N.map(e=>t.jsx(W,{value:e.value,children:e.label},e.value))}),t.jsx(c,{icon:t.jsx(w,{}),onClick:ce,children:"刷新"})]})}),J.length>0?t.jsx(D,{columns:ue,dataSource:J,rowKey:e=>`${e.adapter_name}-${e.device_id}-${e.key}`,pagination:{pageSize:10},scroll:{x:1e3}}):t.jsx(j,{description:"暂无数据流数据"})]})]})}];return t.jsxs("div",{children:[t.jsxs(n,{justify:"space-between",align:"middle",style:{marginBottom:24},children:[t.jsxs(l,{children:[t.jsxs(q,{level:2,style:{margin:0},children:[t.jsx(M,{})," 连接监控"]}),t.jsx(P,{type:"secondary",children:"实时监控适配器和连接器状态"})]}),t.jsx(l,{children:t.jsxs(i,{children:[t.jsx(p,{status:ie?"success":"error",text:ie?"WebSocket已连接":"WebSocket断开"}),t.jsx(c,{icon:t.jsx(w,{}),onClick:ce,loading:s,children:"刷新数据"})]})})]}),!ie&&t.jsx(h,{message:"实时连接断开",description:"WebSocket连接已断开，部分实时功能可能不可用。",type:"warning",showIcon:!0,closable:!0,style:{marginBottom:16}}),t.jsx(y,{activeKey:ae,onChange:ne,items:xe,size:"large"}),t.jsx(g,{title:`适配器诊断 - ${Q}`,open:se,onCancel:()=>re(!1),footer:[t.jsx(c,{onClick:()=>re(!1),children:"关闭"},"close")],width:800,children:ee?t.jsxs("div",{children:[ee.connection_test&&t.jsx(a,{title:"连接测试",size:"small",style:{marginBottom:16},children:t.jsxs(i,{direction:"vertical",style:{width:"100%"},children:[t.jsxs("div",{children:[t.jsx(P,{strong:!0,children:"状态: "}),t.jsx(f,{color:ee.connection_test.success?"success":"error",children:ee.connection_test.success?"成功":"失败"})]}),t.jsxs("div",{children:[t.jsx(P,{strong:!0,children:"响应时间: "}),t.jsxs(P,{children:[ee.connection_test.response_time,"ms"]})]}),ee.connection_test.error&&t.jsxs("div",{children:[t.jsx(P,{strong:!0,children:"错误: "}),t.jsx(P,{type:"danger",children:ee.connection_test.error})]})]})}),ee.health_checks.length>0&&t.jsx(a,{title:"健康检查",size:"small",style:{marginBottom:16},children:t.jsx(i,{direction:"vertical",style:{width:"100%"},children:ee.health_checks.map((e,s)=>t.jsx("div",{children:t.jsxs(i,{children:[t.jsx(f,{color:"pass"===e.status?"success":"warn"===e.status?"warning":"error",children:e.check_name}),t.jsx(P,{children:e.message}),t.jsxs(P,{type:"secondary",children:["(",e.duration,"ms)"]})]})},s))})}),ee.performance_test&&t.jsx(a,{title:"性能测试",size:"small",style:{marginBottom:16},children:t.jsxs(n,{gutter:16,children:[t.jsx(l,{span:12,children:t.jsx(d,{title:"吞吐量",value:ee.performance_test.throughput_per_sec,suffix:"ops/sec"})}),t.jsx(l,{span:12,children:t.jsx(d,{title:"平均延迟",value:ee.performance_test.avg_latency,suffix:"ns"})})]})}),ee.recommendations.length>0&&t.jsx(a,{title:"优化建议",size:"small",children:t.jsx("ul",{children:ee.recommendations.map((e,s)=>t.jsx("li",{children:e},s))})})]}):t.jsx(_,{})})]})};export{G as default};
//# sourceMappingURL=MonitoringPage-pT9ry3lq.js.map
