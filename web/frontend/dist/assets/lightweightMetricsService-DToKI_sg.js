class o{gatewayBaseUrl="";async getLightweightMetrics(e="json"){const t=`${this.gatewayBaseUrl}/metrics${e==="text"?"?format=text":""}`;try{console.log("Fetching metrics from:",t);const r=await fetch(t);if(console.log("Response status:",r.status,r.statusText),!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText} (URL: ${t})`);if(e==="text"){const s=await r.text();return this.parseTextMetrics(s)}else{const s=await r.json();return console.log("Received metrics data:",s),s}}catch(r){throw console.error("Failed to fetch lightweight metrics from:",t,r),r}}async getSystemHealth(){const e=`${this.gatewayBaseUrl}/health`;try{const t=await fetch(e);if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);return await t.json()}catch(t){throw console.error("Failed to fetch system health:",t),t}}async getSystemInfo(){const e=`${this.gatewayBaseUrl}/info`;try{const t=await fetch(e);if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);return await t.json()}catch(t){throw console.error("Failed to fetch system info:",t),t}}parseTextMetrics(e){return{system:{uptime_seconds:0,memory_usage_bytes:0,cpu_usage_percent:0,disk_usage_percent:0,goroutine_count:0,gc_pause_ms:0,heap_size_bytes:0,heap_in_use_bytes:0,network_in_bytes:0,network_out_bytes:0,network_in_packets:0,network_out_packets:0,network_in_bytes_per_sec:0,network_out_bytes_per_sec:0,network_in_packets_per_sec:0,network_out_packets_per_sec:0,version:"",go_version:""},gateway:{status:"unknown",start_time:"",config_file:"",plugins_directory:"",total_adapters:0,running_adapters:0,total_sinks:0,running_sinks:0,nats_connected:!1,nats_connection_url:"",web_ui_port:0,api_port:0},data:{total_data_points:0,data_points_per_second:0,total_bytes_processed:0,bytes_per_second:0,average_latency_ms:0,max_latency_ms:0,min_latency_ms:0,last_data_point_time:"",data_queue_length:0,processing_errors_count:0},connections:{active_connections:0,total_connections:0,failed_connections:0,connections_by_type:{},connections_by_status:{},average_response_time_ms:0,connection_errors:0,reconnection_count:0},rules:{total_rules:0,enabled_rules:0,rules_matched:0,actions_executed:0,actions_succeeded:0,actions_failed:0,average_execution_time_ms:0,rule_engine_status:"unknown",last_rule_execution:""},performance:{throughput_per_second:0,p50_latency_ms:0,p95_latency_ms:0,p99_latency_ms:0,queue_length:0,processing_time:{},resource_utilization:{}},errors:{total_errors:0,errors_per_second:0,errors_by_type:{},errors_by_level:{},last_error:"",last_error_time:"",error_rate:0,recovery_count:0},last_updated:new Date().toISOString()}}formatUptime(e){if(e<60)return`${Math.floor(e)}秒`;if(e<3600)return`${Math.floor(e/60)}分钟`;if(e<86400){const t=Math.floor(e/3600),r=Math.floor(e%3600/60);return`${t}小时${r}分钟`}else{const t=Math.floor(e/86400),r=Math.floor(e%86400/3600);return`${t}天${r}小时`}}formatBytes(e){if(e===0)return"0 B";const t=1024,r=["B","KB","MB","GB","TB"],s=Math.floor(Math.log(e)/Math.log(t));return`${parseFloat((e/Math.pow(t,s)).toFixed(1))} ${r[s]}`}formatNumber(e,t=1){return e>=1e6?`${(e/1e6).toFixed(t)}M`:e>=1e3?`${(e/1e3).toFixed(t)}K`:e.toFixed(t)}formatLatency(e){return e<1?`${(e*1e3).toFixed(0)}μs`:e<1e3?`${e.toFixed(1)}ms`:`${(e/1e3).toFixed(2)}s`}getStatusColor(e){switch(e){case"running":case"healthy":return"success";case"stopped":case"degraded":return"warning";case"error":case"unhealthy":return"error";default:return"default"}}}const a=new o;export{a as l};
