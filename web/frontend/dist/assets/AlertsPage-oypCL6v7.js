import{j as e,a as _e}from"./index-BEjgWUn2.js";import{a,aH as he,a0 as I,p as K,a2 as Me,o as ne,f as ie,k as F,s as D,u as h,v as B,P as xe,a3 as re,w as R,F as i,V as v,z as A,y as L,I as b,B as j,K as ee,a5 as te,U as le,h as Oe,aw as N,T as Pe,a1 as qe,a8 as se,D as Ve,aa as fe,ad as Be}from"./antd-BFy_CllK.js";import{u as ge,a as g}from"./useRealTimeData-BUsqV8Uu.js";import"./vendor-DavUf6mE.js";import"./websocketService-DUqqsEfN.js";class Je{cache=new Map;maxSize;constructor(c=100){this.maxSize=c}get(c){const d=this.cache.get(c);return d?Date.now()>d.expiry?(this.cache.delete(c),null):d:null}set(c,d,p){if(this.cache.size>=this.maxSize){const n=this.cache.keys().next().value;this.cache.delete(n)}const o={data:d,timestamp:Date.now(),expiry:Date.now()+p};this.cache.set(c,o)}isStale(c,d){const p=this.cache.get(c);if(!p||!d)return!1;const o=p.timestamp+d;return Date.now()>o}delete(c){this.cache.delete(c)}clear(){this.cache.clear()}size(){return this.cache.size}keys(){return Array.from(this.cache.keys())}}const z=new Je(200);function J(l,c,d={}){const{ttl:p=5*60*1e3,staleWhileRevalidate:o=30*1e3}=d,n=z.get(l),[u,r]=a.useState(n?.data||null),[S,y]=a.useState(!n),[M,w]=a.useState(null),[k,m]=a.useState(!1),T=a.useRef(null),x=a.useRef(!0),q=a.useRef(c);a.useEffect(()=>{q.current=c},[c]);const $=a.useCallback(async(O=!1)=>{if(console.log(`🔄 [useSmartCache] loadData开始 - key: ${l}, forceRefresh: ${O}`),T.current&&T.current.abort(),!O){const f=z.get(l);if(console.log(`💾 [useSmartCache] 缓存检查 - key: ${l}, 有缓存: ${!!f}`),f){x.current&&(console.log(`✅ [useSmartCache] 使用缓存数据 - key: ${l}`),r(f.data),w(null),m(z.isStale(l,o)),y(!1)),z.isStale(l,o)&&(console.log(`🔄 [useSmartCache] 数据过期，后台更新 - key: ${l}`),setTimeout(()=>$(!0),0));return}}x.current&&(console.log(`⏳ [useSmartCache] 开始加载数据 - key: ${l}`),y(!0),w(null));try{T.current=new AbortController,console.log(`📡 [useSmartCache] 调用fetchFn - key: ${l}`);const f=await q.current();console.log(`✅ [useSmartCache] fetchFn成功 - key: ${l}`,f),console.log(`🔍 [useSmartCache] isMountedRef.current: ${x.current} - key: ${l}`),x.current||(console.log(`🔧 [useSmartCache] 重新设置isMountedRef为true - key: ${l}`),x.current=!0),x.current?(console.log(`💾 [useSmartCache] 设置数据和缓存 - key: ${l}`),r(f),w(null),m(!1),y(!1),z.set(l,f,p)):console.warn(`⚠️ [useSmartCache] 组件已卸载，跳过设置数据 - key: ${l}`)}catch(f){if(console.error(`❌ [useSmartCache] 加载失败 - key: ${l}`,f),x.current&&f instanceof Error&&f.name!=="AbortError"){console.error("useSmartCache error:",f),w(f),(f.message.includes("401")||f.message.includes("unauthorized")||f.message.includes("未提供认证令牌"))&&(console.warn("认证错误，清除缓存"),z.delete(l));const E=z.get(l);E&&(r(E.data),m(!0)),y(!1)}}finally{x.current&&(console.log(`🏁 [useSmartCache] 完成加载 - key: ${l}`),y(!1))}},[l,p,o]),H=a.useCallback(async()=>{await $(!0)},[$]),_=a.useCallback(()=>{z.delete(l),x.current&&(r(null),w(null),m(!1))},[l]);return a.useEffect(()=>{console.log(`🚀 [useSmartCache] 初始加载 effect 触发 for key: ${l}`),$()},[$]),a.useEffect(()=>()=>{x.current=!1,T.current&&T.current.abort()},[]),{data:u,loading:S,error:M,isStale:k,refresh:H,clear:_}}const Ke=({enabled:l=!0,position:c="topRight"})=>{const{data:d}=ge(),[p,o]=a.useState(new Set);return a.useEffect(()=>{!l||!d||!d.alerts||d.alerts.forEach(n=>{if(!p.has(n.id))if(o(u=>new Set(u).add(n.id)),n.type==="alert_created"){const u=n.data,r=y=>{switch(y){case"critical":return e.jsx(ie,{style:{color:"#ff4d4f"}});case"error":return e.jsx(ne,{style:{color:"#ff7a45"}});case"warning":return e.jsx(Me,{style:{color:"#fa8c16"}});default:return e.jsx(K,{style:{color:"#52c41a"}})}},S=y=>{switch(y){case"critical":return"严重";case"error":return"错误";case"warning":return"警告";case"info":return"信息";default:return y}};he.open({message:`新告警：${u.title}`,description:e.jsxs("div",{children:[e.jsx("p",{children:u.description}),e.jsxs("div",{style:{marginTop:8},children:[e.jsx(I,{color:He(u.level),text:`级别: ${S(u.level)}`}),e.jsxs("span",{style:{marginLeft:16},children:["来源: ",u.source]})]})]}),icon:r(u.level),placement:c,duration:u.level==="critical"?0:6,key:u.id,onClick:()=>{window.location.hash="#/alerts"}})}else n.type==="alert_resolved"&&he.success({message:"告警已解决",description:`告警 ${n.data.alert_id} 已被解决`,placement:c,duration:3,key:`resolved-${n.data.alert_id}`})})},[d,l,c,p]),a.useEffect(()=>{const n=setInterval(()=>{o(u=>{const r=Date.now(),S=new Set;return u.forEach(y=>{const M=parseInt(y.split("-")[0])||0;r-M<3e5&&S.add(y)}),S})},6e4);return()=>clearInterval(n)},[]),null},He=l=>{switch(l){case"critical":return"#ff4d4f";case"error":return"#ff7a45";case"warning":return"#fa8c16";case"info":return"#1890ff";default:return"#d9d9d9"}},Ue=({stats:l,loading:c=!1})=>{if(!l)return null;const d=l.total>0?l.active/l.total*100:0,p=l.total>0?l.resolved/l.total*100:0,o=l.byLevel||{},n=l.bySource||{};return e.jsxs(F,{title:"告警统计",style:{marginBottom:16},loading:c,children:[e.jsxs(D,{gutter:16,children:[e.jsx(h,{span:6,children:e.jsx(B,{title:"总告警数",value:l.total,prefix:e.jsx(ie,{}),valueStyle:{color:"#1890ff"}})}),e.jsx(h,{span:6,children:e.jsx(B,{title:"活跃告警",value:l.active,prefix:e.jsx(ne,{}),valueStyle:{color:"#ff4d4f"},suffix:e.jsx(xe,{percent:d,size:"small",strokeColor:"#ff4d4f",showInfo:!1,style:{marginLeft:8,width:60}})})}),e.jsx(h,{span:6,children:e.jsx(B,{title:"已确认",value:l.acknowledged,prefix:e.jsx(K,{}),valueStyle:{color:"#fa8c16"}})}),e.jsx(h,{span:6,children:e.jsx(B,{title:"已解决",value:l.resolved,prefix:e.jsx(re,{}),valueStyle:{color:"#52c41a"},suffix:e.jsx(xe,{percent:p,size:"small",strokeColor:"#52c41a",showInfo:!1,style:{marginLeft:8,width:60}})})})]}),e.jsxs(D,{gutter:16,style:{marginTop:16},children:[e.jsx(h,{span:12,children:e.jsx(F,{size:"small",title:"按级别统计",style:{height:200},children:e.jsxs(R,{direction:"vertical",style:{width:"100%"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(I,{color:"#ff4d4f",text:"严重"}),e.jsx("span",{children:o.critical||0})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(I,{color:"#fa8c16",text:"错误"}),e.jsx("span",{children:o.error||0})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(I,{color:"#faad14",text:"警告"}),e.jsx("span",{children:o.warning||0})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(I,{color:"#1890ff",text:"信息"}),e.jsx("span",{children:o.info||0})]})]})})}),e.jsx(h,{span:12,children:e.jsx(F,{size:"small",title:"按来源统计",style:{height:200},children:e.jsxs(R,{direction:"vertical",style:{width:"100%"},children:[Object.entries(n).map(([u,r])=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:u}),e.jsx(I,{count:r,showZero:!0,color:"#1890ff"})]},u)),Object.keys(n).length===0&&e.jsx("div",{style:{textAlign:"center",color:"#999"},children:"暂无数据"})]})})})]})]})},ae=[{value:"info",label:"信息",color:"blue"},{value:"warning",label:"警告",color:"orange"},{value:"error",label:"错误",color:"red"},{value:"critical",label:"严重",color:"purple"}],We=[{value:"active",label:"活跃",color:"red"},{value:"acknowledged",label:"已确认",color:"orange"},{value:"resolved",label:"已解决",color:"green"}],je=[{value:"email",label:"邮件",icon:e.jsx(N,{})},{value:"webhook",label:"Webhook",icon:e.jsx(N,{})},{value:"sms",label:"短信",icon:e.jsx(N,{})},{value:"slack",label:"Slack",icon:e.jsx(N,{})},{value:"dingtalk",label:"钉钉",icon:e.jsx(N,{})}],{Text:me}=Pe,{Option:C}=A,et=()=>{const[l,c]=a.useState("alerts"),[d,p]=a.useState(!1),{isAuthenticated:o,isInitialized:n,initialize:u}=_e(),[r,S]=a.useState({page:1,pageSize:20}),y=a.useMemo(()=>`alerts-${JSON.stringify(r)}`,[r]),M=a.useCallback(()=>(console.log("📡 AlertsPage: 调用 alertService.getAlerts, filters:",r),g.getAlerts(r)),[r]),{data:w,loading:k,error:m,isStale:T,refresh:x}=J(y,M,{ttl:2*60*1e3,staleWhileRevalidate:30*1e3}),q=a.useCallback(()=>g.getAlertRules(),[]),$=a.useCallback(()=>g.getNotificationChannels(),[]),H=a.useCallback(()=>g.getAlertStats(),[]),{data:_,loading:O,refresh:f}=J("alert-rules",q,{ttl:10*60*1e3}),{data:E,loading:ce,refresh:oe}=J("notification-channels",$,{ttl:10*60*1e3}),U=w?.alerts||[],pe=w?.total||0,ye=Array.isArray(_)?_:[],de=Array.isArray(E)?E:[],{data:ve,loading:Ce}=J("alert-stats",H,{ttl:1*60*1e3}),[we,W]=a.useState(!1),[Se,Q]=a.useState(!1),[be,Y]=a.useState(!1),[Z]=i.useForm(),[G]=i.useForm(),[X]=i.useForm(),{data:V}=ge(),P=a.useRef(null);a.useEffect(()=>{console.log("🔍 AlertsPage 认证状态:",{isInitialized:n,isAuthenticated:o}),n||(console.log("🚀 AlertsPage 初始化认证状态..."),u())},[n,u,o]),a.useEffect(()=>{l==="alerts"?p(k):l==="rules"?p(O):l==="channels"&&p(ce)},[l,k,O,ce]);const ue=a.useCallback(()=>{P.current&&clearTimeout(P.current),P.current=setTimeout(()=>{l==="alerts"&&x()},1e3)},[l,x]);a.useEffect(()=>{V&&V.alerts&&V.alerts.length>0&&l==="alerts"&&ue()},[V?.alerts,l,ue]),a.useEffect(()=>()=>{P.current&&clearTimeout(P.current)},[]),a.useEffect(()=>{m&&v.error("获取告警列表失败: "+m.message)},[m]),a.useEffect(()=>{console.log("AlertsPage 数据状态:",{isInitialized:n,isAuthenticated:o,alertsLoading:k,alertsError:m?.message,alertsCount:w?.alerts?.length||0,rulesCount:_?.length||0,channelsCount:E?.length||0,activeTab:l})},[n,o,w,_,E,k,m,l]);const Ae=async t=>{try{await g.acknowledgeAlert(t,"手动确认"),v.success("告警确认成功"),x()}catch(s){v.error("确认告警失败: "+s.message)}},ke=async t=>{try{await g.resolveAlert(t,"手动解决"),v.success("告警解决成功"),x()}catch(s){v.error("解决告警失败: "+s.message)}},Ie=async t=>{try{await g.deleteAlert(t),v.success("告警删除成功"),x()}catch(s){v.error("删除告警失败: "+s.message)}},Te=async()=>{try{const t=await Z.validateFields(),s={title:t.title,description:t.description,level:t.level,source:t.source||"manual",data:t.data?JSON.parse(t.data):{}};await g.createAlert(s),v.success("告警创建成功"),W(!1),Z.resetFields(),x()}catch(t){v.error("创建告警失败: "+t.message)}},ze=async()=>{try{const t=await G.validateFields(),s={name:t.name,description:t.description,enabled:t.enabled,level:t.level,condition:{type:t.conditionType,field:t.field,operator:t.operator,value:t.value},notificationChannels:t.notificationChannels||[]};await g.createAlertRule(s),v.success("告警规则创建成功"),Q(!1),G.resetFields(),f()}catch(t){v.error("创建告警规则失败: "+t.message)}},Re=async()=>{try{const t=await X.validateFields(),s={name:t.name,type:t.type,enabled:t.enabled,config:t.config?JSON.parse(t.config):{}};await g.createNotificationChannel(s),v.success("通知渠道创建成功"),Y(!1),X.resetFields(),oe()}catch(t){v.error("创建通知渠道失败: "+t.message)}},$e=async t=>{try{await g.testNotificationChannel(t),v.success("测试通知发送成功")}catch(s){v.error("测试通知失败: "+s.message)}},Ee=[{title:"标题",dataIndex:"title",key:"title",ellipsis:!0},{title:"级别",dataIndex:"level",key:"level",width:80,render:t=>e.jsx(L,{color:g.getAlertLevelColor(t),children:g.getAlertLevelText(t)})},{title:"状态",dataIndex:"status",key:"status",width:100,render:t=>e.jsx(L,{color:g.getAlertStatusColor(t),icon:t==="active"?e.jsx(ne,{}):t==="acknowledged"?e.jsx(K,{}):e.jsx(re,{}),children:g.getAlertStatusText(t)})},{title:"来源",dataIndex:"source",key:"source",width:120,render:(t,s)=>e.jsxs("div",{children:[e.jsx("div",{children:t}),s.rule_name&&e.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["规则: ",s.rule_name]})]})},{title:"设备/键值",key:"device_key",width:150,render:(t,s)=>e.jsxs("div",{children:[s.device_id&&e.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["设备: ",s.device_id]}),s.key&&e.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["键: ",s.key]}),s.value&&e.jsxs("div",{style:{fontSize:"12px",color:"#666"},children:["值: ",JSON.stringify(s.value)]})]})},{title:"创建时间",dataIndex:"createdAt",key:"createdAt",width:160,render:t=>{try{const s=t instanceof Date?t:new Date(t);return isNaN(s.getTime())?"无效时间":s.toLocaleString("zh-CN")}catch{return"无效时间"}}},{title:"操作",key:"actions",width:200,render:(t,s)=>e.jsxs(R,{size:"small",children:[s.status==="active"&&e.jsx(fe,{title:"确认告警",children:e.jsx(j,{size:"small",icon:e.jsx(K,{}),onClick:()=>Ae(s.id),children:"确认"})}),(s.status==="active"||s.status==="acknowledged")&&e.jsx(fe,{title:"解决告警",children:e.jsx(j,{size:"small",type:"primary",icon:e.jsx(re,{}),onClick:()=>ke(s.id),children:"解决"})}),e.jsx(Be,{title:"确定要删除这个告警吗？",onConfirm:()=>Ie(s.id),children:e.jsx(j,{size:"small",danger:!0,children:"删除"})})]})}],Le=[{title:"名称",dataIndex:"name",key:"name"},{title:"级别",dataIndex:"level",key:"level",width:80,render:t=>e.jsx(L,{color:g.getAlertLevelColor(t),children:g.getAlertLevelText(t)})},{title:"状态",dataIndex:"enabled",key:"enabled",width:80,render:t=>e.jsx(I,{status:t?"success":"default",text:t?"启用":"禁用"})},{title:"条件",key:"condition",render:(t,s)=>e.jsxs(me,{code:!0,children:[s.condition.field," ",s.condition.operator," ",s.condition.value]})},{title:"通知渠道",dataIndex:"notificationChannels",key:"notificationChannels",render:t=>e.jsxs("span",{children:[t?.length||0," 个渠道"]})},{title:"操作",key:"actions",width:150,render:t=>e.jsxs(R,{size:"small",children:[e.jsx(j,{size:"small",children:"测试"}),e.jsx(j,{size:"small",children:"编辑"}),e.jsx(j,{size:"small",danger:!0,children:"删除"})]})}],De=[{title:"名称",dataIndex:"name",key:"name"},{title:"类型",dataIndex:"type",key:"type",width:100,render:t=>{const s=je.find(Fe=>Fe.value===t);return e.jsxs("span",{children:[s?.icon," ",s?.label||t]})}},{title:"状态",dataIndex:"enabled",key:"enabled",width:80,render:t=>e.jsx(I,{status:t?"success":"default",text:t?"启用":"禁用"})},{title:"创建时间",dataIndex:"createdAt",key:"createdAt",width:160,render:t=>{try{const s=t instanceof Date?t:new Date(t);return isNaN(s.getTime())?"无效时间":s.toLocaleString("zh-CN")}catch{return"无效时间"}}},{title:"操作",key:"actions",width:150,render:(t,s)=>e.jsxs(R,{size:"small",children:[e.jsx(j,{size:"small",icon:e.jsx(N,{}),onClick:()=>$e(s.id),children:"测试"}),e.jsx(j,{size:"small",children:"编辑"}),e.jsx(j,{size:"small",danger:!0,children:"删除"})]})}],Ne=[{key:"alerts",label:e.jsxs("span",{children:[e.jsx(ie,{}),"告警列表",U.filter(t=>t.status==="active").length>0&&e.jsx(I,{count:U.filter(t=>t.status==="active").length,style:{marginLeft:8}})]}),children:e.jsxs("div",{children:[e.jsx(Ue,{stats:ve,loading:Ce}),e.jsx(F,{size:"small",style:{marginBottom:16},children:e.jsxs(D,{gutter:16,children:[e.jsx(h,{span:4,children:e.jsx(A,{placeholder:"告警级别",allowClear:!0,value:r.level,onChange:t=>S({...r,level:t,page:1}),children:ae.map(t=>e.jsx(C,{value:t.value,children:e.jsx(L,{color:t.color,children:t.label})},t.value))})}),e.jsx(h,{span:4,children:e.jsx(A,{placeholder:"告警状态",allowClear:!0,value:r.status,onChange:t=>S({...r,status:t,page:1}),children:We.map(t=>e.jsx(C,{value:t.value,children:e.jsx(L,{color:t.color,children:t.label})},t.value))})}),e.jsx(h,{span:4,children:e.jsx(b,{placeholder:"来源筛选",allowClear:!0,value:r.source,onChange:t=>S({...r,source:t.target.value,page:1})})}),e.jsx(h,{span:6,children:e.jsx(b.Search,{placeholder:"搜索告警",allowClear:!0,value:r.search,onChange:t=>S({...r,search:t.target.value,page:1}),onSearch:()=>x()})}),e.jsx(h,{span:6,children:e.jsxs(R,{children:[e.jsx(j,{icon:e.jsx(ee,{}),onClick:x,loading:k,type:T?"primary":"default",children:T?"数据过期，点击刷新":"刷新"}),e.jsx(j,{type:"primary",icon:e.jsx(te,{}),onClick:()=>W(!0),children:"手动创建告警"})]})})]})}),e.jsx(F,{children:e.jsx(le,{columns:Ee,dataSource:U,rowKey:"id",loading:d,pagination:{current:r.page,pageSize:r.pageSize,total:pe,onChange:(t,s)=>S({...r,page:t,pageSize:s}),showSizeChanger:!0,showQuickJumper:!0,showTotal:(t,s)=>`第 ${s[0]}-${s[1]} 条，共 ${t} 条`}})})]})},{key:"rules",label:e.jsxs("span",{children:[e.jsx(Oe,{}),"告警规则"]}),children:e.jsxs(F,{children:[e.jsx("div",{style:{marginBottom:16},children:e.jsxs(R,{children:[e.jsx(j,{icon:e.jsx(ee,{}),onClick:f,children:"刷新"}),e.jsx(j,{type:"primary",icon:e.jsx(te,{}),onClick:()=>Q(!0),children:"创建规则"})]})}),e.jsx(le,{columns:Le,dataSource:ye,rowKey:"id",loading:d,pagination:{pageSize:10}})]})},{key:"channels",label:e.jsxs("span",{children:[e.jsx(N,{}),"通知渠道"]}),children:e.jsxs(F,{children:[e.jsx("div",{style:{marginBottom:16},children:e.jsxs(R,{children:[e.jsx(j,{icon:e.jsx(ee,{}),onClick:oe,children:"刷新"}),e.jsx(j,{type:"primary",icon:e.jsx(te,{}),onClick:()=>Y(!0),children:"创建渠道"})]})}),e.jsx(le,{columns:De,dataSource:de,rowKey:"id",loading:d,pagination:{pageSize:10}})]})}];if(!n)return e.jsx("div",{style:{padding:"20px",textAlign:"center"},children:"初始化中..."});if(!o)return e.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[e.jsx("p",{children:"请先登录系统"}),e.jsx(j,{type:"primary",onClick:()=>window.location.href="/login",children:"去登录"})]});if(console.log("🎯 AlertsPage 渲染状态:",{isInitialized:n,isAuthenticated:o,alertsLoading:k,hasAlertsData:!!w,alertsError:m?.message}),k&&!w&&!m)return console.log("⏳ AlertsPage: 显示加载中状态"),e.jsx("div",{style:{padding:"20px",textAlign:"center"},children:"加载中..."});if(m&&!w){const t=m.message.includes("401")||m.message.includes("unauthorized")||m.message.includes("未提供认证令牌");return e.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[e.jsxs("p",{children:["加载失败: ",m.message]}),t?e.jsxs("div",{children:[e.jsx("p",{children:"请先登录系统"}),e.jsx(j,{type:"primary",onClick:()=>window.location.href="/login",children:"去登录"})]}):e.jsx(j,{onClick:()=>window.location.reload(),children:"重新加载"})]})}return e.jsxs("div",{children:[e.jsx(Ke,{enabled:!0,position:"topRight"}),e.jsxs("div",{style:{marginBottom:24},children:[e.jsx("h2",{children:"告警管理"}),e.jsx(me,{type:"secondary",children:"管理系统告警、告警规则和通知渠道"})]}),e.jsx(qe,{activeKey:l,onChange:c,items:Ne}),e.jsx(se,{title:"创建告警",open:we,onOk:Te,onCancel:()=>W(!1),width:600,children:e.jsxs(i,{form:Z,layout:"vertical",children:[e.jsx(i.Item,{name:"title",label:"告警标题",rules:[{required:!0}],children:e.jsx(b,{placeholder:"请输入告警标题"})}),e.jsx(i.Item,{name:"description",label:"告警描述",rules:[{required:!0}],children:e.jsx(b.TextArea,{rows:3,placeholder:"请输入告警描述"})}),e.jsxs(D,{gutter:16,children:[e.jsx(h,{span:12,children:e.jsx(i.Item,{name:"level",label:"告警级别",rules:[{required:!0}],children:e.jsx(A,{placeholder:"选择告警级别",children:ae.map(t=>e.jsx(C,{value:t.value,children:e.jsx(L,{color:t.color,children:t.label})},t.value))})})}),e.jsx(h,{span:12,children:e.jsx(i.Item,{name:"source",label:"告警来源",children:e.jsx(b,{placeholder:"请输入告警来源"})})})]}),e.jsx(i.Item,{name:"data",label:"附加数据",children:e.jsx(b.TextArea,{rows:3,placeholder:"请输入JSON格式的附加数据（可选）"})})]})}),e.jsx(se,{title:"创建告警规则",open:Se,onOk:ze,onCancel:()=>Q(!1),width:700,children:e.jsxs(i,{form:G,layout:"vertical",children:[e.jsx(i.Item,{name:"name",label:"规则名称",rules:[{required:!0}],children:e.jsx(b,{placeholder:"请输入规则名称"})}),e.jsx(i.Item,{name:"description",label:"规则描述",children:e.jsx(b.TextArea,{rows:2,placeholder:"请输入规则描述"})}),e.jsxs(D,{gutter:16,children:[e.jsx(h,{span:12,children:e.jsx(i.Item,{name:"level",label:"告警级别",rules:[{required:!0}],children:e.jsx(A,{placeholder:"选择告警级别",children:ae.map(t=>e.jsx(C,{value:t.value,children:e.jsx(L,{color:t.color,children:t.label})},t.value))})})}),e.jsx(h,{span:12,children:e.jsx(i.Item,{name:"enabled",label:"启用状态",initialValue:!0,children:e.jsxs(A,{children:[e.jsx(C,{value:!0,children:"启用"}),e.jsx(C,{value:!1,children:"禁用"})]})})})]}),e.jsx(Ve,{children:"告警条件"}),e.jsxs(D,{gutter:16,children:[e.jsx(h,{span:8,children:e.jsx(i.Item,{name:"field",label:"字段名",rules:[{required:!0}],children:e.jsx(b,{placeholder:"如: temperature"})})}),e.jsx(h,{span:8,children:e.jsx(i.Item,{name:"operator",label:"操作符",rules:[{required:!0}],children:e.jsxs(A,{placeholder:"选择操作符",children:[e.jsx(C,{value:"gt",children:"大于 (>)"}),e.jsx(C,{value:"lt",children:"小于 (<)"}),e.jsx(C,{value:"eq",children:"等于 (=)"}),e.jsx(C,{value:"gte",children:"大于等于 (≥)"}),e.jsx(C,{value:"lte",children:"小于等于 (≤)"})]})})}),e.jsx(h,{span:8,children:e.jsx(i.Item,{name:"value",label:"阈值",rules:[{required:!0}],children:e.jsx(b,{placeholder:"如: 80"})})})]}),e.jsx(i.Item,{name:"notificationChannels",label:"通知渠道",children:e.jsx(A,{mode:"multiple",placeholder:"选择通知渠道（可选）",children:de.map(t=>e.jsx(C,{value:t.id,children:t.name},t.id))})})]})}),e.jsx(se,{title:"创建通知渠道",open:be,onOk:Re,onCancel:()=>Y(!1),width:600,children:e.jsxs(i,{form:X,layout:"vertical",children:[e.jsx(i.Item,{name:"name",label:"渠道名称",rules:[{required:!0}],children:e.jsx(b,{placeholder:"请输入渠道名称"})}),e.jsxs(D,{gutter:16,children:[e.jsx(h,{span:12,children:e.jsx(i.Item,{name:"type",label:"渠道类型",rules:[{required:!0}],children:e.jsx(A,{placeholder:"选择渠道类型",children:je.map(t=>e.jsxs(C,{value:t.value,children:[t.icon," ",t.label]},t.value))})})}),e.jsx(h,{span:12,children:e.jsx(i.Item,{name:"enabled",label:"启用状态",initialValue:!0,children:e.jsxs(A,{children:[e.jsx(C,{value:!0,children:"启用"}),e.jsx(C,{value:!1,children:"禁用"})]})})})]}),e.jsx(i.Item,{name:"config",label:"渠道配置",rules:[{required:!0}],children:e.jsx(b.TextArea,{rows:6,placeholder:`请输入JSON格式的渠道配置，例如：
{
  "url": "https://hooks.slack.com/...",
  "channel": "#alerts"
}`})})]})})]})};export{et as AlertsPage};
