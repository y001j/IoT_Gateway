# IoT Gateway 规则配置示例

本文件夹包含了IoT网关规则引擎的示例配置文件，展示了不同类型规则的使用方法。

## 📁 文件说明

### 01_temperature_alert_example.json
**温度报警示例**
- **功能**: 当温度超过40°C时触发报警
- **特性**: 使用表达式条件，多通道报警（console + websocket）
- **技术**: 表达式引擎、多通道报警、数据转换
- **适用场景**: 环境监控、设备过热保护

### 02_humidity_aggregation_example.json  
**湿度聚合示例**
- **功能**: 对湿度数据进行10点平均值聚合
- **特性**: 计数窗口聚合，实时统计
- **技术**: 聚合引擎、滑动窗口、统计函数
- **适用场景**: 数据平滑、趋势分析

### 03_pressure_filter_example.json
**压力过滤示例** 
- **功能**: 过滤压力数据范围，数据变换处理
- **特性**: 范围过滤 + 数据转换组合
- **技术**: 过滤器、数据转换、标签添加
- **适用场景**: 数据质量控制、数据预处理

### 04_temperature_aggregation_example.json
**温度聚合示例**
- **功能**: 温度数据10点移动平均
- **特性**: 时间窗口聚合，多种统计函数
- **技术**: 聚合管理器、统计计算
- **适用场景**: 数据降噪、趋势监控

### 05_enhanced_filters_example.json ⭐ **新功能**
**增强过滤器示例**
- **功能**: 展示新增的质量过滤器功能
- **特性**: 基于设备质量码的数据过滤
- **技术**: 质量过滤器、工业协议支持
- **适用场景**: 工业设备数据质量保证

### 06_alert_examples.json
**报警配置示例**
- **功能**: 各种报警配置的示例集合
- **特性**: 不同报警级别、多种触发条件
- **技术**: 报警引擎、消息模板
- **适用场景**: 系统监控、故障通知

### 07_transform_examples.json  
**数据转换示例**
- **功能**: 数据转换的各种用法示例
- **特性**: 数值转换、单位换算、字段映射
- **技术**: 转换引擎、表达式计算
- **适用场景**: 数据标准化、格式转换

## 🚀 使用方法

### 1. 单独使用规则文件
将任何一个 `.json` 文件复制到规则引擎监控的目录，系统会自动加载。

### 2. 组合使用多个规则  
可以同时启用多个规则文件，系统按优先级执行。

### 3. 自定义修改
基于示例文件修改参数，创建适合你的业务场景的规则。

## ⚙️ 配置参数说明

### 通用字段
```json
{
  "id": "规则唯一标识",
  "name": "规则显示名称", 
  "description": "规则功能描述",
  "enabled": true,              // 是否启用
  "priority": 100,              // 优先级（数值越大越优先）
  "conditions": { },            // 触发条件
  "actions": [ ]                // 执行动作
}
```

### 条件类型
- **simple**: 简单条件比较
- **expression**: 表达式条件
- **and/or**: 逻辑组合条件

### 动作类型
- **alert**: 发送报警
- **transform**: 数据转换
- **filter**: 数据过滤  
- **aggregate**: 数据聚合
- **forward**: 数据转发

## 🔧 调试和测试

1. **查看日志**: 规则执行情况会记录在系统日志中
2. **Web界面**: 通过Web UI查看规则执行状态和统计
3. **逐步测试**: 先启用简单规则，再组合复杂规则

## 📊 性能建议

- **优先级设置**: 重要规则设置更高优先级
- **条件优化**: 简单条件比表达式条件性能更好
- **合理聚合**: 避免过小的聚合窗口影响性能
- **过滤在前**: 先过滤再聚合，提高效率

## 🆘 常见问题

**Q: 规则不生效？**
A: 检查 `enabled: true` 和条件匹配

**Q: 报警太频繁？**  
A: 调整报警阈值或增加throttle设置

**Q: 数据聚合不准确？**
A: 检查窗口大小和触发条件设置

**Q: 新增强过滤器如何使用？**
A: 参考 `05_enhanced_filters_example.json` 中的配置

更多详细文档请参考 `docs/` 目录中的相关文档。